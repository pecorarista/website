<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@pecorarista">
    <meta name="twitter:title" content="確率的最適化手法Adamの論文のLemma 10.3 — pecorarista.com">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="https://pecorarista.com/static/images/avatar.png">
    <link rel="icon" href="/favicon.ico">
		<script>
			(function(d) {
				var config = {
					kitId: 'mbi1yhb',
					scriptTimeout: 3000,
					async: true
				},
				h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/\bwf-loading\b/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
			})(document);
		</script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Amiri&family=Noto+Sans:ital,wght@0,400;0,700;1,400;1,700&family=Noto+Serif:ital@0;1&family=Roboto+Mono:wght@400;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootswatch@4.5.2/dist/cosmo/bootstrap.min.css" integrity="sha384-5QFXyVb+lrCzdN228VS3HmzpiE7ZVwLQtkt+0d9W43LQMzz4HBnnqvVxKg6O+04d" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-lucario.min.css" integrity="sha512-Aj5jCt/M5XlTn+Y93TazO+EjpRTiUGMrMuaJOcBcu80Fopd7+LSL094m3pbVTNJxf1hOAMSYI/hONBGjvPWwGQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="/static/css/main.css"/>

    <title>確率的最適化手法Adamの論文のLemma 10.3</title>
  </head>
  <body>
    <div class="wrapper">
      <header>
        <nav class="navbar navbar-dark">
  <div class="container">
    <a class="navbar-brand" href="/">pecorarista.com</a>

    <div class="navbar-nav ms-auto d-flex flex-md-row flex-column align-items-md-center">
      <a class="nav-link active" href="/fictional-works">Fictional Works</a>
      <span class="separator d-none d-md-inline">&#10022;</span>
      <a class="nav-link active" href="/technical-notes">Technical Notes</a>
    </div>
  </div>
</nav>

      </header>
      <main>
        
<article>
  <div class="container">
    <h1>確率的最適化手法Adamの論文のLemma 10.3</h1>
    <div class="info text-muted">
      Posted: 2016-03-30
      
    </div>
    
<section>
<p><a href="http://arxiv.org/pdf/1412.6980v8">Adam: A Method for Stochastic Optimization</a>のLemma 10.3が、少し腑に落ちなかったので自分用に書いたメモです。</p>
<p>論文中の証明では、帰納法の仮定から導かれる式
\begin{align*}
    \sum_{t = 1}^T \sqrt{\frac{g_{t,i}^2}{t}}
    \leq 2
    G_\infty\sqrt{\norm{g_{1:T,i}}_2^2 - g_{T,i}^2} + \sqrt{\frac{g_{T,i}^2}{T}}
\end{align*}
に、以下の不等式
\begin{align*}
  \sqrt{\norm{g_{1:T,i}}_2^2 - g_{T,i}^2} \leq \norm{g_{1:T,i}}_2 - \frac{g_{T,i}^2}{2\sqrt{TG_\infty^2}}
\end{align*}
を代入して
\begin{align*}
    \sum_{t = 1}^T \sqrt{\frac{g_{t,i}^2}{t}} \leq 2 G_\infty\norm{g_{1:T,i}}_2
\end{align*}
を示す、と書いてあります。</p>
<p>しかし実際に代入してみると
\begin{align*}
  \sum_{t = 1}^T \sqrt{\frac{g_{t,i}^2}{t}}
  &amp; \leq 2 G_\infty\sqrt{\norm{g_{1:T,i}}_2^2 - g_{T,i}^2} + \sqrt{\frac{g_{T,i}^2}{T}} \\
  &amp; \leq 2G_\infty \parentheses{ \norm{g_{1:T,i}}_2 - \frac{g_{T,i}^2}{2\sqrt{TG_\infty^2}} } + \sqrt{\frac{g_{T,i}^2}{T}} \\
  &amp;= 2G_\infty \norm{g_{1:T,i}}_2 - \frac{g_{T,i}^2}{\sqrt{T}} + \sqrt{\frac{g_{T,i}^2}{T}} \\
  &amp;= 2G_\infty \norm{g_{1:T,i}}_2 + \frac{\sqrt{g_{T,i}^2} - g_{T,i}^2}{\sqrt{T}}
\end{align*}
となるので、<span class="quarter"></span>\(0 \lt \abs{g_{T,i}} \lt 1\)
のとき成り立たないような気がします。大きな誤差にはならないのでこれでもいいのかもしれませんが、せっかくなので別な方法を考えてみたいと思います。</p>
<p>上から抑える方法として以下のCauchy&ndash;Schwarzの不等式を使う方法が考えられます。</p>
\begin{align*}
  \sum_{t = 1}^T \sqrt{\frac{g_{t,i}^2}{t}}
  &amp;=
    \parentheses{
      \begin{array}{c}
        \sqrt{g_{1,i}^2} \\
        \vdots \\
        \sqrt{g_{T,i}^2}
      \end{array}
    }
    \cdot
    \parentheses{
      \begin{array}{c}
        1/\sqrt{1} \\
        \vdots \\
        1/\sqrt{T} \\
    \end{array}
    } \\
  &amp; \leq
  \norm{
    \parentheses{
      \begin{array}{c}
        \sqrt{g_{1,i}^2} \\
        \vdots \\
        \sqrt{g_{T,i}^2}
      \end{array}
    }}_2
    \norm{
      \parentheses{
        \begin{array}{c}
          1/\sqrt{1} \\
          \vdots \\
          1/\sqrt{T} \\
        \end{array}}
      }_2 \\
  &amp;=
  \norm{g_{1:T,i}}_2
  \sqrt{
    \sum_{t = 1}^T \frac{1}{t}
  } \\
  &amp; \leq
  \norm{g_{1:T,i}}_2
  \sqrt{\int_1^T
    \parentheses{1 + \frac{1}{t}} dt
  } \\
  &amp;= \norm{g_{1:T,i}}_2 \sqrt{T - 1 + \log T}
\end{align*}
<p>この変更を行っても\(
  \sqrt{T - 1 + \log T}\) が \(O(\sqrt{T})
\)なので以降の議論に大きな影響はないはずです（あとできちんと確認します）。とりあえず自分の中ではこれで納得したいと思います。</p>
</section>

  </div>
</article>

      </main>
      <footer>
        <div class="footer text-center">
  <span>© 2015&ndash;2025 Akira Miyazawa</span>
</div>

      </footer>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap.native@latest/dist/bootstrap-native.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js" integrity="sha512-SkmBfuA2hqjzEVpmnMt/LINrjop3GKWqsuLSSB3e7iBmYK7JuWw4ldmmxwD9mdm2IRTTi0OxSAfEGvgEi0i2Kw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://kit.fontawesome.com/30a99ec99f.js" crossorigin="anonymous"></script>
<script src="/static/js/main.js"></script>

      
        <script src="/static/js/mathjax.js"></script>
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js?config=TeX-AMS_HTML"></script>
        </script>
      
    </div>
  </body>
</html>
