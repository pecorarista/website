<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@pecorarista">
  <meta name="twitter:title" content="Windows Terminalの背景を透明にして動画を流す方法 — pecorarista.com">
  <meta name="twitter:description" content="">
  <meta name="twitter:image" content="https://pecorarista.com/static/images/avatar.png">
  <link rel="icon" href="/favicon.ico">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700&amp;subset=cyrillic,cyrillic-ext,greek,greek-ext,latin-ext,vietnamese" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono&amp;subset=cyrillic,cyrillic-ext,greek,greek-ext,latin-ext,vietnamese" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Amiri&amp;subset=arabic,latin-ext" />
  <link href="https://fonts.googleapis.com/css?family=Judson&amp;subset=latin-ext,vietnamese&text=abcdefghijklmnopqrstuvwxyz%C9%90%C9%91%C3%A6%CA%8C%C9%93%CA%99%CE%B2%C3%A7%C9%95%C9%97%C9%96%C3%B0%C9%99%C9%9B%C9%A1%C9%A2%C9%A3%C9%A4%C9%A6%C4%A7%C9%A5%C9%A8%C5%8B%C9%B3%C9%B4%C9%AA%C9%94%C3%B8%C5%93%C9%B8%C9%B9%C9%BE%CA%80%CA%81%CE%B8%CA%83%CA%8A%CF%87%CA%92%CA%94%CA%95%CB%A0%CA%B2%E2%81%BF%CA%B7%E2%97%8B%CC%83%CB%90" rel="stylesheet">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootswatch/4.3.1/cosmo/bootstrap.min.css" />
  <link rel="stylesheet" href="/static/css/prism-lucario.css" />
  <link rel="stylesheet" href="/static/css/main.css" />

  <title>Windows Terminalの背景を透明にして動画を流す方法</title>
</head>

<body>
  <div class="wrapper">
    <header>
      <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
          <div class="navbar-header pull-left"><a class="navbar-brand" href="/">pecorarista.com</a></div>
          <div class="navbar-header pull-right">
            <ul class="navbar-nav">
              <li class="nav-item"><a class="nav-link active" href="/resources">Resources</a></li>
            </ul>
          </div>
        </div>
      </nav>

    </header>
    <main>

      <article>
        <div class="container">
          <h1>Windows Terminalの背景を透明にして動画を流す方法</h1>
          <div class="info text-muted">
            Posted: 2022-09-23

          </div>

          <section>
            <p>基本的には
              <a href="https://github.com/microsoft/terminal/issues/14059">microsoft/terminal/issues/14059</a>
              に書いたことと同じなのですが、日本語で情報が見つからなかったので、日本語でも書いておきたいと思います。
            </p>
            <figure style="text-align: center;">
              <figcaption>
                ターミナルの背後で動画
                <a href="https://www.youtube.com/watch?v=qZP0l-mZvqY">
                  <i class="fa-brands fa-youtube"></i>
                </a>
                を再生している様子。
              </figcaption>
              <video src="/static/videos/windows-terminal-transparent-video.mp4" alt="Video being played behind a transparent terminal" style="width: 70%;" loop autoplay muted>
            </figure>
            <div class="toc-container">
              <h4 class="toc-title">目次</h4>
              <ol>
                <li><a href="#terminal">Windows Terminal側の設定</a>
                <li><a href="#browser">ブラウザ側の設定</a>
                  <ol>
                    <li><a href="#chrome"><i class="fa-brands fa-chrome"></i> Google Chromeの場合</a></li>
                    <li><a href="#firefox"><i class="fa-brands fa-firefox-browser"></i> Firefoxの場合</h3></a></li>
                  </ol>
                </li>
              </ol>
            </div>
          </section>
          <section>
            <h2 id="terminal">Windows Terminal側の設定</h2>
            <p>Windows Terminal画面のタイトルバーを右クリックし
              <strong>Settings</strong>
              を選択します。
              画面左側の
              <strong>Profiles</strong>
              の一覧の中から、変更したい項目、
              例えば
              <strong><i class="fa fa-linux" aria-hidden="true"></i> Ubuntu-20.04</strong>
              を選択します。
            <figure>
              <img src="/static/images/profiles.png" style="max-width: 100%;" alt="Windows Terminal; Profiles">
            </figure>
            画面右側に設定項目の一覧が表示されるので、その中の
            <strong>Additional settings &gt; Appearance</strong>
            を選択します。
            </p>
            <figure>
              <img src="/static/images/additional-settings.png" style="max-width: 100%;" alt="Windows Terminal; Additional settings">
            </figure>
            <strong>Transparency</strong>
            の
            <strong>Background opacity</strong>（不透明度）
            を80%程度に設定します。
            <figure>
              <img src="/static/images/transparency.png" style="max-width: 100%;" alt="Windows Terminal; Transparency">
            </figure>
            右下の
            <strong>Save</strong>
            を押して変更を確定します。
          </section>

          <section>
            <h2 id="browser">ブラウザ側の設定</h2>
            <p>上記の設定でターミナルの背景は透明になりますが、ある問題が生じます。それはブラウザのCPUやメモリを節約しようとする仕組みによって、<span style="text-decoration: underline;">Windows Terminalを全画面にしたときにブラウザの画面の描画が停止する</span>という問題です。例えば、背景で動画を再生するときや、Webアプリケーションのコードを変更した結果をプレビューするときなどに、その問題が生じます。これらはターミナルを透明にする主たる理由ですから、これでは透明にする意義がほとんど失われてしまいます。</p>
            <p>上記のブラウザの挙動はごく一部の人以外には望ましい挙動であり、今後修正されることはおそらくないでしょう。したがってこの問題は自分でWebブラウザの設定を変更して解決する必要があります。</p>
            <section>
              <h3 id="chrome"><i class="fa-brands fa-chrome"></i> Google Chromeの場合</h3>
              <p>アドレスバーに
                <code>chrome://flags/#calculate-native-win-occlusion</code>
                と入力して、設定画面の
                <strong>Calculate window occlusion on Windows</strong>
                の項目を
                <code>Disabled</code>
                に設定します。
              </p>
              <figure>
                <img src="/static/images/chrome.png" style="max-width: 100%;" alt="Google Chrome; Calculate window occlusion on Windows">
              </figure>
              <p>Reference: <a href="https://support.google.com/chrome/thread/77201393/videos-turn-black-when-a-full-screen-window-is-on-top-of-the-window-playing-the-video">Videos turn black when a full screen window is "on top" of the window playing the video.</a></p>
            </section>
            <section>
              <h3 id="firefox"><i class="fa-brands fa-firefox-browser"></i> Firefoxの場合</h3>
              <p>アドレスバーに
                <code>about:config</code>
                と入力します。警告が出る場合がありますが、設定を変更したいので
                <strong>Accept the Risk and Continue</strong>
                を選択します。
              <figure>
                <img src="/static/images/caution.png" style="max-width: 100%;" alt="Firefox; Proceed with Caution">
              </figure>
              次の画面では設定を変更したい項目の名前を検索する欄が表示されるので、そこに
              <code>widget.windows.window_occlusion_tracking.enabled</code>
              と打ち込みます。
              <figure>
                <img src="/static/images/preference.png" style="max-width: 100%;" alt="Firefox; Search preference name">
              </figure>
              双方向の矢印のアイコンをクリックして値を
              <code>false</code>
              に変更します。
              </p>
              <figure>
                <img src="/static/images/toggle.png" style="max-width: 100%;" alt="Firefox; Toggle the parameter">
              </figure>
              </p>Reference: <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1759393">Firefox stops rendering videos (the whole web-page) after 10 seconds when in background</a>
              </p>
            </section>
          </section>

        </div>
      </article>

    </main>
    <footer>
      <div class="footer text-center">
        <span>© 2015&ndash;2022 Akira Miyazawa</span>
      </div>

    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap.native@2.0.15/dist/bootstrap-native-v4.min.js"></script>
    <script src="/static/js/prism.js"></script>
    <script src="/static/js/prism-bash.min.js"></script>
    <script src="/static/js/prism-latex.min.js"></script>
    <script src="/static/js/prism-makefile.min.js"></script>
    <script src="/static/js/prism-java.min.js"></script>
    <script src="/static/js/prism-javascript.min.js"></script>
    <script src="/static/js/prism-scala.min.js"></script>
    <script src="/static/js/prism-markdown.min.js"></script>
    <script src="/static/js/prism-apacheconf.min.js"></script>
    <script src="/static/js/prism-perl.min.js"></script>
    <script src="/static/js/prism-haskell.min.js"></script>
    <script src="/static/js/prism-lua.min.js"></script>
    <script src="https://kit.fontawesome.com/30a99ec99f.js" crossorigin="anonymous"></script>
    <script>
      (function(d) {
        var config = {
            kitId: 'huy3ylo',
            scriptTimeout: 3000,
            async: true
          },
          h = d.documentElement,
          t = setTimeout(function() {
            h.className = h.className.replace(/\bwf-loading\b/g, "") + " wf-inactive";
          }, config.scriptTimeout),
          tk = d.createElement("script"),
          f = false,
          s = d.getElementsByTagName("script")[0],
          a;
        h.className += " wf-loading";
        tk.src = 'https://use.typekit.net/' + config.kitId + '.js';
        tk.async = true;
        tk.onload = tk.onreadystatechange = function() {
          a = this.readyState;
          if (f || a && a != "complete" && a != "loaded")
            return;
          f = true;
          clearTimeout(t);
          try {
            Typekit.load(config)
          } catch (e) {}
        };
        s.parentNode.insertBefore(tk, s)
      })(document);
    </script>
    <script src="/static/js/main.js"></script>


    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
    <script>
      MathJax = {
        tex: {
          macros: {
            parentheses: ["\\left(#1\\right)", 1],
            brackets: ["\\left[#1\\right]", 1],
            norm: ["\\left\\|#1\\right\\|", 1],
            abs: ["\\left|#1\\right|", 1],
            diag: "\\mathop{\\rm diag}",
            res: "\\mathop{\\rm Res}",
            real: "\\mathop{\\rm Re}",
            imaginary: "\\mathop{\\rm Im}"
          },
          tags: 'ams'
        }
      };
    </script>

  </div>
</body>

</html>