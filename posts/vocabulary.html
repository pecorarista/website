<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@pecorarista">
  <meta name="twitter:title" content="Markdown → LaTeXで単語帳 — pecorarista.com">
  <meta name="twitter:description" content="">
  <meta name="twitter:image" content="https://pecorarista.com/static/images/avatar.png">
  <link rel="icon" href="/favicon.ico">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700&amp;subset=cyrillic,cyrillic-ext,greek,greek-ext,latin-ext,vietnamese" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono&amp;subset=cyrillic,cyrillic-ext,greek,greek-ext,latin-ext,vietnamese" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Amiri&amp;subset=arabic,latin-ext" />
  <link href="https://fonts.googleapis.com/css?family=Judson&amp;subset=latin-ext,vietnamese&text=abcdefghijklmnopqrstuvwxyz%C9%90%C9%91%C3%A6%CA%8C%C9%93%CA%99%CE%B2%C3%A7%C9%95%C9%97%C9%96%C3%B0%C9%99%C9%9B%C9%A1%C9%A2%C9%A3%C9%A4%C9%A6%C4%A7%C9%A5%C9%A8%C5%8B%C9%B3%C9%B4%C9%AA%C9%94%C3%B8%C5%93%C9%B8%C9%B9%C9%BE%CA%80%CA%81%CE%B8%CA%83%CA%8A%CF%87%CA%92%CA%94%CA%95%CB%A0%CA%B2%E2%81%BF%CA%B7%E2%97%8B%CC%83%CB%90" rel="stylesheet">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootswatch/4.3.1/cosmo/bootstrap.min.css" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous" />
  <link rel="stylesheet" href="/static/css/prism-lucario.css" />
  <link rel="stylesheet" href="/static/css/main.css" />

  <title>Markdown → LaTeXで単語帳</title>
</head>

<body>
  <div class="wrapper">
    <header>
      <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
          <div class="navbar-header pull-left"><a class="navbar-brand" href="/">pecorarista.com</a></div>
          <div class="navbar-header pull-right">
            <ul class="navbar-nav">
              <li class="nav-item"><a class="nav-link active" href="/resources">Resources</a></li>
            </ul>
          </div>
        </div>
      </nav>

    </header>
    <main>

      <article>
        <div class="container">
          <h1>Markdown → LaTeXで単語帳</h1>
          <div class="info text-muted">
            Posted: 2015-09-16

            (Modified: 2019-03-26)

          </div>

          <section>
            <p>単語帳を作る作業は簡略化したいものの、ラテン文字以外の文字を正確に表示してくれる環境はなかなかないものです。そこでLaTeXの機能で表示を頑張りつつ、単語のリストの作成はMarkdownで簡略化するという方法で作成することにしました。依存するツールが増えるとインストールが大変なので、PandocとTeX Live、そして表示したい言語のフォント以外は準備しなくても大丈夫な方法を考えてみました。以下は中国語、ロシア語、アラビア語の単語で実際に作ってみた例です。</p>
            <figure>
              <figcaption>単語帳の例</figcaption>
              <div class="pseudocode">
                <img src="/static/images/words.svg" style="background-color: white; padding: 20px; min-width: 100%;" />
              </div>
            </figure>
            <p>文法用語の省略記法は<a href="https://en.wikipedia.org/wiki/List_of_glossing_abbreviations"><em>List of glossing abbreviations</em></a>を使っています。</p>
          </section>
          <section>
            <h2>1. フォントの取得</h2>
            <p>単語帳を作成したい言語や発音記号で使われている文字を含むフォントを持っているか確認します。Windowsの場合は<kbd>Win</kbd> <code>fonts</code>で、Linuxの場合は<code>fc-list</code>コマンドでインストール済みのフォントの一覧が表示されます。</p>
            <p>多くの文字を含み、かつ入手しやすいフォントとして以下のようなものがあります。</p>
            <ul>
              <li><a href="https://www.gnu.org/software/freefont/">GNU FreeFont</a></li>
              <li><a href="https://www.google.com/get/noto/">Google Noto Fonts</a></li>
              <li><a href="https://bboxtype.com/typefaces/FiraGO/#!layout=specimen">FiraGo</a></li>
            </ul>
            <p>発音記号用のフォントとしては以下が入手しやすいです。</p>
            <ul>
              <li><a href="https://software.sil.org/doulos/download/">Doulos SIL</a></li>
              <li><a href="https://fonts.google.com/specimen/Judson">Judson</a></li>
              <li><a href="https://fonts.google.com/specimen/Voces">Voces</a></li>
            </ul>
          </section>
          <section>
            <h2>2. テンプレートの作成</h2>
            <p>各言語に対応したフォントが自動で割り当てられるようにbabelなどのパッケージの設定を書いたテンプレートを準備しておきます。これを<code>vocabulary.tex</code>などの名前で保存します。</p>
            <figure>
              <pre><code class="language-latex">\documentclass[12pt,a4paper]{ltjsarticle}
\usepackage[no-math]{luatexja-fontspec}
\usepackage{babel}
\babelprovide{russian}
% \babelprovide{polutonikogreek}
\ltjsetparameter{%
    jacharrange={%
        -2, % Exclude Greek and Cyrillic letters.
        -3  % Punctuations and Miscellaneous symbols.
    },
    alxspmode={`/,allow}
}
\babelfont[russian]{sf}[Script=Cyrillic]{OpenSans}
\usepackage{arabluatex}
\setmainfont[Ligatures=TeX]{Free Serif}
\setmainjfont[BoldFont={RyuminPro-Regular}]{RyuminPro-Light}
\newjfontfamily\chinesefont{Hiragino Sans GB}
\newfontfamily\phonetic{Doulos SIL}
\newfontfamily\translitfont{Free Serif}
\newfontfamily\arabicfont[%
    Script=Arabic,     % enable ligatures
    RawFeature={%
        +anum,         % use eastern arabic numerals
        +ss05}        % put kasrah below shadda
]{Scheherazade-Bold}
\SetTranslitFont{\translitfont}
\SetTranslitStyle{\upshape}  % \upshape, \itshape
\SetTranslitConvention{dmg}  % dmg, loc, arabica
\newcommand\tightlist{\relax}
\newcommand\ArabicWord[1]{\mbox{\arb[novoc]{#1}} \arb[trans]{#1}}
\newcommand\ChineseWord[1]{\begin{chinesefont}#1\end{chinesefont}}
\newcommand\RussianWord[1]{\foreignlanguage{russian}{\textsf{#1}}}
\pagestyle{empty}
\begin{document}
  $body$
\end{document}
</code></pre>
            </figure>
            <p>次にPandocの「フィルター」と呼ばれるものを書きます。これを使ってMarkdownからLaTeXに変換する方法を指定し、少しでも入力が楽になるようにします。ここでは頻繁に入力するスモールキャピタルはアンダースコア2つ<code>__</code>で入力できるようにしました。またロシア語アルファベットが使われている部分は、自動でロシア語とマークアップされるようにしました。</p>
            <figure>
              <pre><code class="language-lua">function isrussian (s)
  i = utf8.offset(s, 1)
  j = utf8.offset(s, 2) - 1
  uchar = string.sub(s, i, j)
  return uchar &gt;= &#39;А&#39; and uchar &lt;= &#39;я&#39;
end

function isphonetic (s)
  return string.sub(s, 1, 1) == &#39;/&#39;
end

function Strong (elem)
  return pandoc.SmallCaps(elem.content)
end

function Str (elem)
  if isrussian(elem.text) then
    return pandoc.RawInline(&#39;latex&#39;, &#39;\\RussianWord{&#39; .. elem.text .. &#39;}&#39;)
  elseif isphonetic(elem.text) then
    return pandoc.RawInline(&#39;latex&#39;, &#39;{\\phonetic &#39; .. elem.text .. &#39;}&#39;)
  else
    return pandoc.Str(elem.text)
  end
end
</code></pre>
            </figure>
          </section>
          <section>
            <h2>3. 単語のリスト作成</h2>
            <p>Markdown形式で単語のリストを書いていきます。テキストエディタを使い、以下のような単語のリストを作って<code>words.md</code>のような名前で保存します。アラビア文字の入力の仕方は<a href="https://pecorarista.com/posts/arabluatex.html">「LaTeXでRTL（右横書き）の文書をつくる」</a>を、発音記号の入力の仕方は<a href="https://pecorarista.com/posts/type-ipa.html"><em>How to type phonetic symbols</em></a>をご参照ください。</p>
            <figure>
              <pre><code class="language-markdown">* \ChineseWord{狐狸} húli /xʷuu˥lʲii/ 狐
* \ChineseWord{春节} chūnjié /ʈʂʰʷən˥tɕee˧˥/ 春節
* \ChineseWord{近日} jìnrì /tɕin˥˩ʐʐʐ˥˩/ このごろ
* убивать /ʊbʲɪˈvatʲ/ __impf__ __[+ acc]__ 殺す
* воздух /ˈvozdʊx/ __m__ 大気
* \ArabicWord{rI.huN} __f__ 風
* \ArabicWord{^samAluN} __m__ 北
    * \ArabicWord{rI.hu &#39;l-^samAli} 北風
* \ArabicWord{tatajAdalu} (\arb[novoc]{fI} + etw.) bestreiten __3sg f impf__
    ← \ArabicWord{tajadala}
</code></pre>
            </figure>
            <p>タイプセットする際にLuaLaTeXを使いたいので<code>latexmkrc</code>を作ります。</p>
            <figure>
              <pre><code class="language-perl">#!/usr/bin/perl
$pdflatex = &#39;lualatex %O %S&#39;;
$bibtex = &#39;upbibtex %O %B&#39;;
$pdf_mode = 1;
$bibtex_use = 2;
$clean_ext .= &#39;%R.bbl %R.ltjruby %R.nav %R.snm %R.vrb&#39;;
</code></pre>
            </figure>
            <p>以下のコマンドを実行して最終的にPDFファイルを得ます。</p>
            <pre class="command-line"><code class="language-bash">pandoc --from=markdown --to=latex \
  --template=vocabulary.tex --lua-filter=filter.lua \
  --standalone --output=words.tex words.md
latexmk words.tex</code></pre>
          </section>

        </div>
      </article>

    </main>
    <footer>
      <div class="footer text-center">
        <span>© 2015&ndash;2022 Akira Miyazawa</span>
      </div>

    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap.native@2.0.15/dist/bootstrap-native-v4.min.js"></script>
    <script src="/static/js/prism.js"></script>
    <script src="/static/js/prism-bash.min.js"></script>
    <script src="/static/js/prism-latex.min.js"></script>
    <script src="/static/js/prism-makefile.min.js"></script>
    <script src="/static/js/prism-java.min.js"></script>
    <script src="/static/js/prism-javascript.min.js"></script>
    <script src="/static/js/prism-scala.min.js"></script>
    <script src="/static/js/prism-markdown.min.js"></script>
    <script src="/static/js/prism-apacheconf.min.js"></script>
    <script src="/static/js/prism-perl.min.js"></script>
    <script src="/static/js/prism-haskell.min.js"></script>
    <script src="/static/js/prism-lua.min.js"></script>
    <script>
      (function(d) {
        var config = {
            kitId: 'huy3ylo',
            scriptTimeout: 3000,
            async: true
          },
          h = d.documentElement,
          t = setTimeout(function() {
            h.className = h.className.replace(/\bwf-loading\b/g, "") + " wf-inactive";
          }, config.scriptTimeout),
          tk = d.createElement("script"),
          f = false,
          s = d.getElementsByTagName("script")[0],
          a;
        h.className += " wf-loading";
        tk.src = 'https://use.typekit.net/' + config.kitId + '.js';
        tk.async = true;
        tk.onload = tk.onreadystatechange = function() {
          a = this.readyState;
          if (f || a && a != "complete" && a != "loaded")
            return;
          f = true;
          clearTimeout(t);
          try {
            Typekit.load(config)
          } catch (e) {}
        };
        s.parentNode.insertBefore(tk, s)
      })(document);
    </script>
    <script src="/static/js/main.js"></script>


  </div>
</body>

</html>