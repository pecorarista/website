{% extends '_layout/_article.njk' %}
{% set lang = 'ja' %}
{% set mathematical = 'true' %}
{% set title = 'Windows Terminalの背景を透明にして動画を流す方法' %}
{% set posted = '2022-09-23' %}

{% block post %}
<p>基本的には
<a href="https://github.com/microsoft/terminal/issues/14059">microsoft/terminal/issues/14059</a>
に書いたことと同じなのですが、日本語で情報が見つからなかったので、日本語でも書いておきたいと思います。</p>
<figure style="text-align: center;">
  <figcaption>
    ターミナルの背後で動画
    <a href="https://www.youtube.com/watch?v=qZP0l-mZvqY&t=357s">
      <i class="fa-brands fa-youtube"></i>
    </a>
    を再生している様子。
  </figcaption>
  <video
    src="/static/videos/windows-terminal-transparent-video.mp4"
    loop
    autoplay
    muted
    style="width: 70%;"
  >
</figure>
<div class="toc-container">
<p class="toc-title">目次</p>
<ol>
  <li><a href="#terminal">Windows Terminal側の設定</a>
  <li><a href="#browser">ブラウザ側の設定</a>
  <ol>
    <li><a href="#chrome">Google Chromeの場合</a></li>
    <li><a href="#firefox">FireFoxの場合</a></li>
  </ol>
</li>
</ol>
</div>
<h2 id="terminal" class="section-title">Windows Terminal側の設定</h2>
<p>Windows Terminal画面のタイトルバーを右クリックし
<strong>Settings</strong>
を選択します。
画面左側の
<strong>Profiles</strong>
の一覧の中から、変更したい項目、
例えば
<strong><i class="fa fa-linux" aria-hidden="true"></i>Ubuntu 20.04</strong>
を選択します。
<figure>
  <img src="/static/images/profiles.png" alt="Windows Terminal; Profiles">
</figure>
すると画面右側に設定項目の一覧が出るので、そこで
<strong>Additional settings &gt; Appearance</strong>
を選択します。
</p>
<figure>
  <img src="/static/images/additional-settings.png" alt="Windows Terminal; Additional settings">
</figure>
<strong>Transparency</strong>
の
<strong>Background opacity</strong>
を80%程度に設定します。
<figure>
  <img src="/static/images/transparency.png" alt="Windows Terminal; Transparency">
</figure>
<h2 id="browser" class="section-title">ブラウザ側の設定</h2>
<p>上記の設定でターミナルの背景は透明になりますが、ある問題が生じます。それはブラウザのCPUやメモリを節約しようとする仕組みによって、ブラウザの画面の描画が停止するのです。例えば、背景で動画を再生するときや、Webアプリケーションのコードを変更した結果をプレビューするときなどに、その問題が起きますが、それらはターミナルを透明にする主たる理由に他なりません。この問題の解決方法を以下で説明します。</p>
<h3 id="chrome" class="section-title">Google Chromeの場合</h3>
<p>アドレスバーに
<code>chrome://flags/#calculate-native-win-occlusion</code>
と入力して、設定画面の
<strong>Calculate window occlusion on Windows</strong>
の項目を
<code>Disabled</code>
に設定します。
  <figure>
    <img src="/static/images/chrome.png" alt="Google Chrome; Calculate window occlusion on Windows">
  </figure>
</p>

<h3 id="firefox" class="section-title">FireFoxの場合</h3>
<p>アドレスバーに
<code>about:config</code>
と入力します。すると警告画面が出ますが
<strong>Accept the Risk and Continue</strong>を選択し、次の画面に進みます。
  <figure>
    <img src="/static/images/caution.png" alt="FireFox; Proceed with Caution">
  </figure>
設定を変更したい項目の名前を検索する欄が出るので、そこに
<code>widget.windows.window_occlusion_tracking.enabled</code>
と打ち込みます。
  <figure>
    <img src="/static/images/preference.png" alt="FireFox; Search preference name">
  </figure>
双方向の矢印のアイコンをクリックして値を
<code>false</code>
に変更します。
  <figure>
    <img src="/static/images/toggle.png" alt="FireFox; Toggle the parameter">
  </figure>
</p>

{% endblock %}
